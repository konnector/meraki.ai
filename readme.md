# Meraki.ai - Modern Web Application

use pnpm no npm 

## Overview
Meraki.ai is a modern web application built with Next.js 15, TypeScript, and a comprehensive set of UI components. The application features secure authentication with Clerk, database functionality through Supabase, and a powerful spreadsheet editor.

## Tech Stack
- **Framework:** Next.js 15.1.0
- **Language:** TypeScript
- **Styling:** Tailwind CSS
- **Authentication:** Clerk (with JWT Templates)
- **Database:** Supabase with Row Level Security
- **UI Components:** Radix UI + shadcn/ui
- **State Management:** React Context & Hooks
- **Form Handling:** React Hook Form with Zod validation
- **Additional Features:**
  - Theme support (next-themes)
  - Modern UI components (shadcn/ui)
  - Charts (Recharts)
  - Toast notifications (Sonner)
  - Date handling (date-fns)

## Features
- ✅ **Secure Authentication**: User sign-up/sign-in with Clerk
- ✅ **Role-Based Access Control**: Implemented with Supabase RLS
- ✅ **Dashboard Interface**: View, search, and organize spreadsheets
- ✅ **Spreadsheet Management**: Create, read, update, delete operations
- ✅ **User-Isolated Data**: Each user can only see their own spreadsheets
- ✅ **Spreadsheet Features**:
  - Real-time data saving
  - Title editing with auto-save
  - Star/unstar functionality
  - Cell formatting
  - Formula support
  - Copy/paste functionality
  - Undo/redo support
- ⬜ **Sharing Functionality**: Coming soon
- ⬜ **Collaboration Tools**: Coming soon
- ⬜ **AI Integration**: Coming soon

## Project Structure
```
├── app/                  # Next.js app directory
│   ├── dashboard/       # Dashboard related pages
│   ├── spreadsheet/    # Spreadsheet functionality
│   ├── settings/       # User settings
│   ├── sign-in/        # Authentication pages
│   └── sign-up/        # User registration
├── components/          # Reusable UI components
│   ├── Dashboard/      # Dashboard-specific components
│   ├── SpreadSheet/    # Spreadsheet editor components
│   └── ui/             # Common UI components
├── hooks/              # Custom React hooks
│   └── useSpreadsheet.ts # Hook for spreadsheet operations
├── lib/                # Utility functions and configurations
│   ├── supabase/      # Supabase client configuration
│   │   ├── client.ts  # Basic client
│   │   ├── clerk-client.ts # Auth integration
│   │   ├── types.ts   # Type definitions
│   │   └── secure-api.ts # Secure database operations
│   └── spreadsheet/   # Spreadsheet logic
│       ├── FormulaParser.ts # Formula parsing
│       └── HistoryManager.ts # Undo/redo functionality
├── context/           # React context providers
├── types/             # TypeScript type definitions
└── public/            # Static assets
```

## Data Storage

Meraki.ai uses Supabase for data storage with the following structure:

### Spreadsheets Table
```sql
CREATE TABLE IF NOT EXISTS public.spreadsheets (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id TEXT NOT NULL DEFAULT requesting_user_id(),
  title TEXT NOT NULL,
  data JSONB DEFAULT '{}',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);
```

The `data` column stores spreadsheet content in JSONB format:
```json
{
  "cells": {
    "A1": {
      "value": "string",
      "formula": "=SUM(B1:B5)",
      "calculatedValue": "number",
      "format": {
        "bold": true,
        "italic": false,
        "align": "center"
      }
    }
  },
  "isStarred": boolean,
  "meta": {
    "rowCount": number,
    "columnCount": number,
    "lastModified": "timestamp"
  }
}
```

## Authentication & Database Integration

Meraki.ai implements a secure integration between Clerk (authentication) and Supabase (database) using:

1. **JWT Templates**: Custom JWT tokens generated by Clerk and verified by Supabase
2. **Row Level Security**: Database-level security policies that restrict data access based on user ID
3. **Secure API Layer**: A custom hook system that handles authentication state and data operations
4. **Client Caching**: Optimization to prevent multiple authentication client instances

This approach provides:
- Strong security without storing sensitive credentials in the frontend
- Database-level access control through RLS policies
- Clean separation of authentication and data layers

## Getting Started

1. Clone the repository
2. Install dependencies:
   ```bash
   pnpm install
   ```
3. Set up environment variables:
   Create a `.env.local` file with:
   ```
   # Clerk Authentication
   NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_...
   CLERK_SECRET_KEY=sk_test_...
   NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
   NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
   NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard
   NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/dashboard
   
   # Supabase Configuration
   NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
   NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIU...
   ```

4. Set up Supabase:
   - Create a JWT template in Clerk Dashboard
   - Set up database tables with RLS enabled
   - Configure database policies

5. Run the development server:
   ```bash
   pnpm dev
   ```

## Development Guidelines
- Use pnpm (no npm) for package management
- Follow TypeScript best practices
- Use provided UI components from the component library
- Implement proper error handling
- Write clean, maintainable code
- Follow the established project structure

## Contributing
[Your contribution guidelines here]

## License
[Your license information here]
