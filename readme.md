# Meraki.ai - Modern Web Application

use pnpm no npm 

## Overview
Meraki.ai is a modern web application built with Next.js 15, TypeScript, and a comprehensive set of UI components. The application features secure authentication with Clerk, database functionality through Supabase, and a powerful spreadsheet editor.

## Tech Stack
- **Framework:** Next.js 15.1.0
- **Language:** TypeScript
- **Styling:** Tailwind CSS
- **Authentication:** Clerk (with JWT Templates)
- **Database:** Supabase with Row Level Security
- **UI Components:** Radix UI + shadcn/ui
- **State Management:** React Context & Hooks
- **Form Handling:** React Hook Form with Zod validation
- **Additional Features:**
  - Theme support (next-themes)
  - Modern UI components (shadcn/ui)
  - Charts (Recharts)
  - Toast notifications (Sonner)
  - Date handling (date-fns)

## Features and Implementation Status
- âœ… **Secure Authentication**: 
  - User sign-up/sign-in with Clerk
  - JWT template configuration
  - Session management
  - Protected routes
- âœ… **Database Integration**: 
  - Supabase setup with RLS
  - JSONB data structure
  - Real-time updates
  - Secure client implementation
- âœ… **Dashboard Interface**: 
  - View and search spreadsheets
  - Organize by starred/recent
  - Clean modern UI
- âœ… **Core Spreadsheet Features**:
  - Real-time data saving with debounce
  - Title editing with auto-save
  - Star/unstar functionality
  - Basic cell formatting
  - Formula support (basic)
  - Copy/paste functionality
  - Undo/redo support
- ðŸŸ¨ **Advanced Spreadsheet Features**:
  - Cell range selection (in progress)
  - Advanced formulas (in progress)
  - Data validation (planned)
  - Custom cell types (planned)
- â¬œ **Collaboration Features**: 
  - Real-time collaboration (planned)
  - User permissions (planned)
  - Version history (planned)
  - Comments and notes (planned)
- â¬œ **AI Integration**: 
  - Formula suggestions (planned)
  - Data analysis (planned)
  - Smart formatting (planned)

## Project Structure
```
â”œâ”€â”€ app/                  # Next.js app directory
â”‚   â”œâ”€â”€ dashboard/       # Dashboard related pages
â”‚   â”œâ”€â”€ spreadsheet/    # Spreadsheet functionality
â”‚   â”œâ”€â”€ settings/       # User settings
â”‚   â”œâ”€â”€ sign-in/        # Authentication pages
â”‚   â””â”€â”€ sign-up/        # User registration
â”œâ”€â”€ components/          # Reusable UI components
â”‚   â”œâ”€â”€ Dashboard/      # Dashboard-specific components
â”‚   â”œâ”€â”€ SpreadSheet/    # Spreadsheet editor components
â”‚   â””â”€â”€ ui/             # Common UI components
â”œâ”€â”€ hooks/              # Custom React hooks
â”‚   â””â”€â”€ useSpreadsheet.ts # Hook for spreadsheet operations
â”œâ”€â”€ lib/                # Utility functions and configurations
â”‚   â”œâ”€â”€ supabase/      # Supabase client configuration
â”‚   â”‚   â”œâ”€â”€ client.ts  # Basic client
â”‚   â”‚   â”œâ”€â”€ clerk-client.ts # Auth integration
â”‚   â”‚   â”œâ”€â”€ types.ts   # Type definitions
â”‚   â”‚   â””â”€â”€ secure-api.ts # Secure database operations
â”‚   â””â”€â”€ spreadsheet/   # Spreadsheet logic
â”‚       â”œâ”€â”€ FormulaParser.ts # Formula parsing
â”‚       â””â”€â”€ HistoryManager.ts # Undo/redo functionality
â”œâ”€â”€ context/           # React context providers
â”œâ”€â”€ types/             # TypeScript type definitions
â””â”€â”€ public/            # Static assets
```

## Data Storage

Meraki.ai uses Supabase for data storage with the following structure:

### Spreadsheets Table
```sql
CREATE TABLE IF NOT EXISTS public.spreadsheets (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id TEXT NOT NULL DEFAULT requesting_user_id(),
  title TEXT NOT NULL,
  data JSONB DEFAULT '{}',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);
```

The `data` column stores spreadsheet content in JSONB format:
```json
{
  "cells": {
    "A1": {
      "value": "string",
      "formula": "=SUM(B1:B5)",
      "calculatedValue": "number",
      "format": {
        "bold": true,
        "italic": false,
        "align": "center"
      }
    }
  },
  "isStarred": boolean,
  "meta": {
    "rowCount": number,
    "columnCount": number,
    "lastModified": "timestamp"
  }
}
```

## Authentication & Database Integration

Meraki.ai implements a secure integration between Clerk (authentication) and Supabase (database) using:

1. **JWT Templates**: Custom JWT tokens generated by Clerk and verified by Supabase
2. **Row Level Security**: Database-level security policies that restrict data access based on user ID
3. **Secure API Layer**: A custom hook system that handles authentication state and data operations
4. **Client Caching**: Optimization to prevent multiple authentication client instances

This approach provides:
- Strong security without storing sensitive credentials in the frontend
- Database-level access control through RLS policies
- Clean separation of authentication and data layers

## Getting Started

1. Clone the repository
2. Install dependencies:
   ```bash
   pnpm install
   ```
3. Set up environment variables:
   Create a `.env.local` file with:
   ```
   # Clerk Authentication
   NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_...
   CLERK_SECRET_KEY=sk_test_...
   NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
   NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
   NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard
   NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/dashboard
   
   # Supabase Configuration
   NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
   NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIU...
   ```

4. Set up Supabase:
   - Create a JWT template in Clerk Dashboard
   - Set up database tables with RLS enabled
   - Configure database policies

5. Run the development server:
   ```bash
   pnpm dev
   ```

## Development Guidelines
- Use pnpm (no npm) for package management
- Follow TypeScript best practices
- Use provided UI components from the component library
- Implement proper error handling
- Write clean, maintainable code
- Follow the established project structure

## Known Issues & Limitations
- Large spreadsheets may experience performance issues
- Some advanced formula calculations may be slow
- Real-time collaboration features not yet implemented
- Limited mobile device support

## Contributing
[Your contribution guidelines here]

## License
[Your license information here]
